<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + React</title>
    <script type="module" crossorigin src="./assets/index-B8czSuXc.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-DgvuG5qn.css">
  </head>
  <body>
    <div id="root"></div>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <script type="text/javascript">
      var modelo = null;var modelo2 = null;

//Cargar modelo
(async () => {
    console.log("Cargando modelo...");
    modelo = await tf.loadGraphModel("/src/assets/modeloIA/modelo5/model.json");
    modelo2 = await tf.loadGraphModel("/src/assets/modeloIA/modelo10/model.json");
    console.log("Modelo cargado...");
})();
function sliceN(array, numeroDePartes) {
  const longitud = array.length;
  const longitudParte = Math.ceil(longitud / numeroDePartes);
  const partes = [];
  
  for (let i = 0; i < longitud; i += longitudParte) {
    const parte = array.slice(i, i + longitudParte);
    partes.push(parte);
  }
  
  return partes;
  }
function argMax(array) {
    // console.log({array})
    const numericArray = array.filter(function(value) {
        return typeof value === 'number' && !isNaN(value);
    });

    // Verificar si el array está vacío
    if (numericArray.length === 0) {
        return -1;
    }

    return array.indexOf(Math.max(...numericArray));
}
const pred2index=(prediccion)=>{
    const indexPredicciones=[]
    
    prediccion.map((pred)=>{
        indexPredicciones.push(argMax(pred))
    })
    
    return indexPredicciones;
}
function predecirSiguiente5(anterior) {
  if (modelo != null) {
    if(anterior.length<11){
      return null
    }
    var tensor = tf.tensor([anterior]);

    const prediccion = modelo.predict(tensor).dataSync();
    console.log({prediccion})
    const arrayPredicciones = sliceN(prediccion,5);
    indexArray= pred2index(arrayPredicciones)
    // console.log({indexArray});
    return indexArray;

  } else {
    console.log("Intenta de nuevo en un momento...");
  }
}
function predecirSiguiente10(anterior) {
  if (modelo != null) {
    if(anterior.length<3){
      return null
    }
    var tensor = tf.tensor([anterior]);

    const prediccion = modelo2.predict(tensor).dataSync();
    const arrayPredicciones = sliceN(prediccion,10);
    indexArray= pred2index(arrayPredicciones)
    // console.log({indexArray});
    return indexArray;

  } else {
    console.log("Intenta de nuevo en un momento...");
  }
}
    </script>
  </body>
</html> 
